os: linux
dist: xenial

language: python
python:
  - 2.7
  - 3.4
  - 3.8
cache:
  pip: true

install:
  - pip install pylint
before_script:
  - pylint SynologyDSM
  - ./scripts/check_format.sh
script:
  - python setup.py install
  - python setup.py sdist

deploy:
  - provider: pypi
    user: $pypi_test_user
    password: $pypi_test_pass
    server: $pypi_test
    on:
      branch: deploy-test
      python: 3.8
  - provider: pypi
    user: $pypi_user
    password: $pypi_pass
    server: $pypi
    on:
      branch: deploy
      python: 3.8
